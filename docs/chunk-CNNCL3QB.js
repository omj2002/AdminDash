import{b as Jt,d as Kt}from"./chunk-XVC4V5VF.js";import{a as ft,b as yt,c as gt,d as Ct,e as xt,f as Mt,g as ht,h as _t,i as Pt,j as vt,k as St,l as A,m as Xt}from"./chunk-GTLK435B.js";import{a as wt,b as Tt}from"./chunk-BFWHI6MN.js";import{a as Ft}from"./chunk-YV3TLQAO.js";import{a as Ot,b as Rt,c as Bt,d as Nt,e as At,f as kt,g as $t,h as Vt,i as jt,j as Gt,k as Ht}from"./chunk-6GSHFZDM.js";import{a as Et,b as $,c as zt,d as Ut}from"./chunk-VVK67SDJ.js";import{b as Lt,c as qt,d as H}from"./chunk-GXHTTDCA.js";import"./chunk-AAIC3GS6.js";import{K as k,n as et,o as b,p as nt}from"./chunk-7LI5U462.js";import{$b as S,$d as bt,Bb as _,Bc as T,Cc as F,Db as M,Dd as it,Fd as h,Hd as at,Id as ot,Kb as Q,La as m,Ld as rt,Md as mt,Nb as W,Nd as lt,Ob as a,Od as st,Pb as y,Pd as dt,Qb as s,Qd as pt,Sd as ct,Ta as c,Ud as O,Vd as R,Xb as Y,Xd as ut,Yb as u,Yd as B,Za as D,Zb as v,Zd as N,_b as I,a as X,b as J,be as Dt,cb as p,fe as It,ie as V,ke as j,ne as G,pa as z,qa as U,qb as l,rb as o,sb as e,tb as f,wb as C,wc as Z,xb as x,xc as tt,yc as E,zb as K,zc as w}from"./chunk-H7G55VRW.js";var L=nt("payments"),Qt=b(L,t=>t.payments),Ie=b(L,t=>t.selectedPayment),Wt=b(L,t=>t.loading),Ee=b(L,t=>t.error);function re(t,n){if(t&1&&(o(0,"div",8)(1,"mat-card")(2,"mat-card-content")(3,"div",9)(4,"strong"),a(5,"Transaction ID:"),e(),a(6),e(),o(7,"div",9)(8,"strong"),a(9,"Customer:"),e(),a(10),e(),o(11,"div",9)(12,"strong"),a(13,"Amount:"),e(),a(14),u(15,"currency"),e(),o(16,"div",9)(17,"strong"),a(18,"Method:"),e(),a(19),e(),o(20,"div",9)(21,"strong"),a(22,"Status:"),e(),o(23,"span"),a(24),u(25,"titlecase"),e()(),o(26,"div",9)(27,"strong"),a(28,"Date:"),e(),a(29),u(30,"date"),e()()()()),t&2){let i=M();m(6),s(" ",i.data.payment.transactionId," "),m(4),s(" ",i.data.payment.customerName," "),m(4),s(" ",S(15,8,i.data.payment.amount,"USD","symbol","1.2-2")," "),m(5),s(" ",i.data.payment.method," "),m(4),W("status-"+i.data.payment.status),m(),y(v(25,13,i.data.payment.status)),m(5),s(" ",I(30,15,i.data.payment.createdAt,"MMM dd, yyyy HH:mm")," ")}}function me(t,n){if(t&1&&(o(0,"div",10)(1,"form",11)(2,"mat-form-field",12)(3,"mat-label"),a(4,"Customer Name"),e(),f(5,"input",13),e(),o(6,"mat-form-field",12)(7,"mat-label"),a(8,"Amount"),e(),f(9,"input",14),o(10,"span",15),a(11,"$\xA0"),e()(),o(12,"mat-form-field",12)(13,"mat-label"),a(14,"Payment Method"),e(),o(15,"mat-select",16)(16,"mat-option",17),a(17,"Credit Card"),e(),o(18,"mat-option",18),a(19,"PayPal"),e(),o(20,"mat-option",19),a(21,"Bank Transfer"),e(),o(22,"mat-option",20),a(23,"Cash"),e()()(),o(24,"mat-form-field",12)(25,"mat-label"),a(26,"Description"),e(),f(27,"textarea",21),e()()()),t&2){let i=M();m(),l("formGroup",i.paymentForm)}}function le(t,n){if(t&1&&(o(0,"div",22)(1,"mat-card")(2,"mat-card-content")(3,"h3"),a(4,"Refund Details"),e(),o(5,"div",9)(6,"strong"),a(7,"Original Amount:"),e(),a(8),u(9,"currency"),e(),o(10,"div",9)(11,"strong"),a(12,"Transaction ID:"),e(),a(13),e()()(),o(14,"form",11)(15,"mat-form-field",12)(16,"mat-label"),a(17,"Refund Amount"),e(),f(18,"input",23),o(19,"span",15),a(20,"$\xA0"),e()(),o(21,"mat-form-field",12)(22,"mat-label"),a(23,"Reason"),e(),f(24,"textarea",24),e()()()),t&2){let i=M();m(8),s(" ",S(9,4,i.data.payment.amount,"USD","symbol","1.2-2")," "),m(5),s(" ",i.data.payment.transactionId," "),m(),l("formGroup",i.refundForm),m(4),l("max",i.data.payment.amount)}}var P=class t{constructor(n,i,r){this.dialogRef=n;this.data=i;this.fb=r;this.paymentForm=this.fb.group({customerName:["",h.required],amount:["",[h.required,h.min(.01)]],method:["",h.required],description:[""]}),this.refundForm=this.fb.group({refundAmount:["",[h.required,h.min(.01)]],reason:["",h.required]})}paymentForm;refundForm;getDialogTitle(){switch(this.data.mode){case"process":return"Process New Payment";case"view":return"Payment Details";case"refund":return"Process Refund";default:return"Payment"}}getDialogIcon(){switch(this.data.mode){case"process":return"payment";case"view":return"visibility";case"refund":return"refresh";default:return"payment"}}getConfirmButtonText(){switch(this.data.mode){case"process":return"Process Payment";case"view":return"Close";case"refund":return"Process Refund";default:return"Confirm"}}isFormValid(){return this.data.mode==="view"?!0:this.data.mode==="process"?this.paymentForm.valid:this.data.mode==="refund"?this.refundForm.valid:!1}onCancel(){this.dialogRef.close()}onConfirm(){if(this.data.mode==="view")this.dialogRef.close();else if(this.data.mode==="process"){let n=this.paymentForm.value;this.dialogRef.close({action:"process",data:n})}else if(this.data.mode==="refund"){let n=this.refundForm.value;this.dialogRef.close({action:"refund",data:n})}}static \u0275fac=function(i){return new(i||t)(c(Mt),c(ht),c(pt))};static \u0275cmp=D({type:t,selectors:[["app-payment-dialog"]],decls:14,vars:7,consts:[[1,"payment-dialog"],["mat-dialog-title",""],["class","payment-details",4,"ngIf"],["class","payment-form",4,"ngIf"],["class","refund-form",4,"ngIf"],["align","end"],["mat-button","",3,"click"],["mat-raised-button","","color","primary",3,"click","disabled"],[1,"payment-details"],[1,"detail-row"],[1,"payment-form"],[3,"formGroup"],["appearance","outline",1,"full-width"],["matInput","","formControlName","customerName","placeholder","Enter customer name"],["matInput","","type","number","formControlName","amount","placeholder","Enter amount"],["matPrefix",""],["formControlName","method"],["value","Credit Card"],["value","PayPal"],["value","Bank Transfer"],["value","Cash"],["matInput","","formControlName","description","placeholder","Payment description (optional)"],[1,"refund-form"],["matInput","","type","number","formControlName","refundAmount","placeholder","Enter refund amount",3,"max"],["matInput","","formControlName","reason","placeholder","Reason for refund"]],template:function(i,r){i&1&&(o(0,"div",0)(1,"h2",1)(2,"mat-icon"),a(3),e(),a(4),e(),o(5,"mat-dialog-content"),p(6,re,31,18,"div",2)(7,me,28,1,"div",3)(8,le,25,9,"div",4),e(),o(9,"mat-dialog-actions",5)(10,"button",6),_("click",function(){return r.onCancel()}),a(11,"Cancel"),e(),o(12,"button",7),_("click",function(){return r.onConfirm()}),a(13),e()()()),i&2&&(m(3),y(r.getDialogIcon()),m(),s(" ",r.getDialogTitle()," "),m(2),l("ngIf",r.data.mode==="view"&&r.data.payment),m(),l("ngIf",r.data.mode==="process"),m(),l("ngIf",r.data.mode==="refund"&&r.data.payment),m(4),l("disabled",!r.isFormValid()),m(),s(" ",r.getConfirmButtonText()," "))},dependencies:[F,Z,A,Pt,St,vt,N,B,k,It,bt,Dt,$,Et,H,qt,Lt,R,O,G,V,j,ct,rt,it,mt,at,ot,dt,lt,st,E,T,w],styles:[".payment-dialog[_ngcontent-%COMP%]{min-width:500px}.payment-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]{margin-bottom:12px;display:flex;justify-content:space-between;align-items:center}.status-completed[_ngcontent-%COMP%]{color:#4caf50;font-weight:700}.status-pending[_ngcontent-%COMP%]{color:#ff9800;font-weight:700}.status-failed[_ngcontent-%COMP%]{color:#f44336;font-weight:700}.full-width[_ngcontent-%COMP%]{width:100%;margin-bottom:16px}.refund-form[_ngcontent-%COMP%]{margin-top:16px}mat-dialog-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}"]})};var se=()=>[];function de(t,n){t&1&&(o(0,"th",18),a(1,"Transaction ID"),e())}function pe(t,n){if(t&1&&(o(0,"td",19),a(1),e()),t&2){let i=n.$implicit;m(),y(i.transactionId)}}function ce(t,n){t&1&&(o(0,"th",18),a(1,"Customer"),e())}function ue(t,n){if(t&1&&(o(0,"td",19),a(1),e()),t&2){let i=n.$implicit;m(),y(i.customerName)}}function fe(t,n){t&1&&(o(0,"th",18),a(1,"Amount"),e())}function ye(t,n){if(t&1&&(o(0,"td",19),a(1),u(2,"currency"),e()),t&2){let i=n.$implicit;m(),y(S(2,1,i.amount,"USD","symbol","1.2-2"))}}function ge(t,n){t&1&&(o(0,"th",18),a(1,"Method"),e())}function Ce(t,n){if(t&1&&(o(0,"td",19),a(1),e()),t&2){let i=n.$implicit;m(),y(i.method)}}function xe(t,n){t&1&&(o(0,"th",18),a(1,"Status"),e())}function Me(t,n){if(t&1&&(o(0,"td",19)(1,"mat-chip",20),a(2),u(3,"titlecase"),e()()),t&2){let i=n.$implicit,r=M();m(),l("color",r.getStatusColor(i.status)),m(),s(" ",v(3,2,i.status)," ")}}function he(t,n){t&1&&(o(0,"th",18),a(1,"Date"),e())}function _e(t,n){if(t&1&&(o(0,"td",19),a(1),u(2,"date"),e()),t&2){let i=n.$implicit;m(),y(I(2,1,i.createdAt,"MMM dd, yyyy"))}}function Pe(t,n){t&1&&(o(0,"th",18),a(1,"Actions"),e())}function ve(t,n){if(t&1){let i=K();o(0,"td",19)(1,"button",21)(2,"mat-icon"),a(3,"more_vert"),e()(),o(4,"mat-menu",null,0)(6,"button",22),_("click",function(){let d=z(i).$implicit,g=M();return U(g.viewPaymentDetails(d))}),o(7,"mat-icon"),a(8,"visibility"),e(),o(9,"span"),a(10,"View Details"),e()(),o(11,"button",22),_("click",function(){let d=z(i).$implicit,g=M();return U(g.refundPayment(d))}),o(12,"mat-icon"),a(13,"refresh"),e(),o(14,"span"),a(15,"Refund"),e()()()()}if(t&2){let i=Q(5);m(),l("matMenuTriggerFor",i)}}function Se(t,n){t&1&&f(0,"tr",23)}function be(t,n){t&1&&f(0,"tr",24)}var Yt=class t{constructor(n,i,r,d,g){this.store=n;this.dialog=i;this.snackBar=r;this.dataService=d;this.persistence=g;this.payments$=this.store.select(Qt),this.loading$=this.store.select(Wt)}displayedColumns=["transactionId","customerName","amount","method","status","createdAt","actions"];payments$;loading$;ngOnInit(){this.persistence.loadList("payments","/data/payments.json").subscribe(n=>{this.store.dispatch(Jt({payments:n}))})}getStatusColor(n){switch(n){case"completed":return"primary";case"pending":return"warn";case"failed":return"accent";default:return"primary"}}processPayment(){this.dialog.open(P,{width:"600px",data:{mode:"process"}}).afterClosed().subscribe(i=>{if(i&&i.action==="process"){let r=this.createPaymentFromFormData(i.data);this.store.dispatch(Kt({payment:r})),this.snackBar.open("Payment processed successfully!","Close",{duration:3e3}),console.log("Payment processed:",r),this.payments$.subscribe(d=>{let g=[...d||[],r];this.persistence.saveList("payments",g)}).unsubscribe()}})}viewPaymentDetails(n){this.dialog.open(P,{width:"500px",data:{mode:"view",payment:n}}).afterClosed().subscribe(r=>{console.log("Payment details viewed for:",n.transactionId)})}refundPayment(n){n.status==="completed"?this.dialog.open(P,{width:"600px",data:{mode:"refund",payment:n}}).afterClosed().subscribe(r=>{r&&r.action==="refund"&&(this.snackBar.open(`Refund processed for ${n.transactionId}`,"Close",{duration:3e3}),console.log("Refund processed:",r.data),this.payments$.subscribe(d=>{let g=(d||[]).map(q=>q.id===n.id?J(X({},q),{status:"refunded"}):q);this.persistence.saveList("payments",g)}).unsubscribe())}):this.snackBar.open("Only completed payments can be refunded","Close",{duration:3e3})}createPaymentFromFormData(n){let i=this.generatePaymentId(),r=this.generateTransactionId();return{id:i,transactionId:r,amount:parseFloat(n.amount),status:"completed",method:n.method,customerName:n.customerName,createdAt:new Date().toISOString().split("T")[0]}}generatePaymentId(){let n=0;return this.payments$.subscribe(i=>{n=i.length}).unsubscribe(),(n+1).toString()}generateTransactionId(){let n=Date.now(),i=Math.floor(Math.random()*1e3);return`TXN-${n}-${i}`}static \u0275fac=function(i){return new(i||t)(c(et),c(_t),c(zt),c(Ft),c(Xt))};static \u0275cmp=D({type:t,selectors:[["app-payments"]],decls:36,vars:6,consts:[["menu","matMenu"],[1,"payments-container"],[1,"payments-header"],["mat-raised-button","","color","primary",3,"click"],[1,"payments-table-card"],[1,"table-container"],["mat-table","",1,"payments-table",3,"dataSource"],["matColumnDef","transactionId"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","customerName"],["matColumnDef","amount"],["matColumnDef","method"],["matColumnDef","status"],["matColumnDef","createdAt"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["selected","",3,"color"],["mat-icon-button","",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(i,r){i&1&&(o(0,"div",1)(1,"div",2)(2,"h1"),a(3,"Payment Management"),e(),o(4,"button",3),_("click",function(){return r.processPayment()}),o(5,"mat-icon"),a(6,"add"),e(),a(7," Process Payment "),e()(),o(8,"mat-card",4)(9,"mat-card-content")(10,"div",5)(11,"table",6),u(12,"async"),C(13,7),p(14,de,2,0,"th",8)(15,pe,2,1,"td",9),x(),C(16,10),p(17,ce,2,0,"th",8)(18,ue,2,1,"td",9),x(),C(19,11),p(20,fe,2,0,"th",8)(21,ye,3,6,"td",9),x(),C(22,12),p(23,ge,2,0,"th",8)(24,Ce,2,1,"td",9),x(),C(25,13),p(26,xe,2,0,"th",8)(27,Me,4,4,"td",9),x(),C(28,14),p(29,he,2,0,"th",8)(30,_e,3,4,"td",9),x(),C(31,15),p(32,Pe,2,0,"th",8)(33,ve,16,1,"td",9),x(),p(34,Se,1,0,"tr",16)(35,be,1,0,"tr",17),e()()()()()),i&2&&(m(11),l("dataSource",v(12,3,r.payments$)||Y(5,se)),m(23),l("matHeaderRowDef",r.displayedColumns),m(),l("matRowDefColumns",r.displayedColumns))},dependencies:[F,Ht,Ot,Bt,$t,Nt,Rt,Vt,At,kt,jt,Gt,G,V,j,N,B,ut,R,O,$,k,H,Tt,wt,Ct,yt,ft,gt,A,Ut,xt,tt,E,T,w],styles:[".payments-container[_ngcontent-%COMP%]{padding:24px;max-width:1200px;margin:0 auto}.payments-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:24px}.payments-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;font-size:32px;font-weight:300;color:#333}.payments-table-card[_ngcontent-%COMP%]{border-radius:12px;box-shadow:0 2px 8px #0000001a}.table-container[_ngcontent-%COMP%]{overflow-x:auto}.payments-table[_ngcontent-%COMP%]{width:100%}.payments-table[_ngcontent-%COMP%]   mat-chip[_ngcontent-%COMP%]{font-size:12px;font-weight:500}@media (max-width: 768px){.payments-container[_ngcontent-%COMP%]{padding:16px}.payments-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:16px}.payments-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:24px}}"]})};export{Yt as PaymentsComponent};

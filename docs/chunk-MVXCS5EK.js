import{b as Ht,d as Lt,e as qt}from"./chunk-5RO2YKBW.js";import{a as st,b as dt,c as ut,d as ft,e as gt,f as Ct,g as St,h as xt,i as _t,j as ht,k as kt,l as j,m as Gt}from"./chunk-GTLK435B.js";import{a as H,b as L}from"./chunk-BFWHI6MN.js";import{a as yt}from"./chunk-YV3TLQAO.js";import{a as Tt,b as wt,c as Et,d as Dt,e as It,f as Nt,g as Pt,h as Ft,i as Ot,j as Rt,k as jt}from"./chunk-6GSHFZDM.js";import{a as bt,b as $,c as At,d as Vt}from"./chunk-VVK67SDJ.js";import{b as Bt,c as $t,d as q}from"./chunk-GXHTTDCA.js";import"./chunk-AAIC3GS6.js";import{K as B,n as tt,o as b,p as et}from"./chunk-7LI5U462.js";import{$d as vt,Bb as _,Cc as N,Db as d,Dd as it,Fd as v,Hd as ot,Id as nt,Kb as W,La as l,Ld as rt,Nd as at,Ob as n,Od as lt,Pb as h,Qb as m,Qd as ct,Sd as mt,Ta as f,Ud as P,Vd as F,Xb as X,Xd as pt,Yb as C,Yd as O,Za as w,Zb as k,Zd as R,_b as E,a as U,b as J,cb as s,fe as Mt,ie as A,ke as V,ne as G,pa as y,qa as T,qb as c,rb as r,sb as e,tb as g,wb as S,wc as Y,xb as x,xc as Z,yc as D,zb as Q,zc as I}from"./chunk-H7G55VRW.js";var z=et("support"),zt=b(z,o=>o.tickets),ye=b(z,o=>o.selectedTicket),Kt=b(z,o=>o.loading),Te=b(z,o=>o.error);function oe(o,t){if(o&1&&(r(0,"div",9)(1,"mat-card")(2,"mat-card-content")(3,"div",10)(4,"strong"),n(5,"Ticket Number:"),e(),n(6),e(),r(7,"div",10)(8,"strong"),n(9,"Subject:"),e(),n(10),e(),r(11,"div",10)(12,"strong"),n(13,"Customer:"),e(),n(14),e(),r(15,"div",10)(16,"strong"),n(17,"Priority:"),e(),r(18,"mat-chip",11),n(19),C(20,"titlecase"),e()(),r(21,"div",10)(22,"strong"),n(23,"Status:"),e(),r(24,"mat-chip",11),n(25),C(26,"titlecase"),e()(),r(27,"div",10)(28,"strong"),n(29,"Created:"),e(),n(30),C(31,"date"),e(),r(32,"div",10)(33,"strong"),n(34,"Description:"),e(),r(35,"p"),n(36),e()()()()()),o&2){let i=d();l(6),m(" ",i.data.ticket.ticketNumber," "),l(4),m(" ",i.data.ticket.subject," "),l(4),m(" ",i.data.ticket.customerName," "),l(4),c("color",i.getPriorityColor(i.data.ticket.priority)),l(),m(" ",k(20,9,i.data.ticket.priority)," "),l(5),c("color",i.getStatusColor(i.data.ticket.status)),l(),m(" ",k(26,11,i.data.ticket.status)," "),l(5),m(" ",E(31,13,i.data.ticket.createdAt,"MMM dd, yyyy HH:mm")," "),l(6),h(i.data.ticket.description||"No description provided")}}function ne(o,t){if(o&1&&(r(0,"div",12)(1,"form",13)(2,"mat-form-field",14)(3,"mat-label"),n(4,"Subject"),e(),g(5,"input",15),e(),r(6,"mat-form-field",14)(7,"mat-label"),n(8,"Customer Name"),e(),g(9,"input",16),e(),r(10,"mat-form-field",14)(11,"mat-label"),n(12,"Priority"),e(),r(13,"mat-select",17)(14,"mat-option",18),n(15,"Low"),e(),r(16,"mat-option",19),n(17,"Medium"),e(),r(18,"mat-option",20),n(19,"High"),e()()(),r(20,"mat-form-field",14)(21,"mat-label"),n(22,"Description"),e(),g(23,"textarea",21),e()()()),o&2){let i=d();l(),c("formGroup",i.ticketForm)}}function re(o,t){if(o&1&&(r(0,"div",22)(1,"mat-card")(2,"mat-card-content")(3,"h3"),n(4),e(),r(5,"div",23)(6,"strong"),n(7,"Subject:"),e(),n(8),e()()(),r(9,"form",13)(10,"mat-form-field",14)(11,"mat-label"),n(12,"Reply Message"),e(),g(13,"textarea",24),e(),r(14,"mat-form-field",14)(15,"mat-label"),n(16,"Status Update"),e(),r(17,"mat-select",25)(18,"mat-option",26),n(19,"Open"),e(),r(20,"mat-option",27),n(21,"In Progress"),e(),r(22,"mat-option",28),n(23,"Resolved"),e()()()()()),o&2){let i=d();l(4),m("Reply to ",i.data.ticket.ticketNumber),l(4),m(" ",i.data.ticket.subject," "),l(),c("formGroup",i.replyForm)}}function ae(o,t){if(o&1&&(r(0,"div",29)(1,"mat-card")(2,"mat-card-content")(3,"h3"),n(4),e(),r(5,"div",23)(6,"strong"),n(7,"Subject:"),e(),n(8),g(9,"br"),r(10,"strong"),n(11,"Current Status:"),e(),r(12,"mat-chip",11),n(13),C(14,"titlecase"),e()()()(),r(15,"form",13)(16,"mat-form-field",14)(17,"mat-label"),n(18,"Resolution Notes"),e(),g(19,"textarea",30),e()()()),o&2){let i=d();l(4),m("Close Ticket ",i.data.ticket.ticketNumber),l(4),m(" ",i.data.ticket.subject," "),l(4),c("color",i.getStatusColor(i.data.ticket.status)),l(),m(" ",k(14,5,i.data.ticket.status)," "),l(2),c("formGroup",i.closeForm)}}var M=class o{constructor(t,i,a){this.dialogRef=t;this.data=i;this.fb=a;this.ticketForm=this.fb.group({subject:["",v.required],customerName:["",v.required],priority:["medium",v.required],description:["",v.required]}),this.replyForm=this.fb.group({message:["",v.required],status:[this.data.ticket?.status||"open",v.required]}),this.closeForm=this.fb.group({resolution:["",v.required]})}ticketForm;replyForm;closeForm;getDialogTitle(){switch(this.data.mode){case"create":return"Create New Ticket";case"view":return"Ticket Details";case"reply":return"Reply to Ticket";case"close":return"Close Ticket";default:return"Support Ticket"}}getDialogIcon(){switch(this.data.mode){case"create":return"add";case"view":return"visibility";case"reply":return"reply";case"close":return"close";default:return"support"}}getConfirmButtonText(){switch(this.data.mode){case"create":return"Create Ticket";case"view":return"Close";case"reply":return"Send Reply";case"close":return"Close Ticket";default:return"Confirm"}}getStatusColor(t){switch(t){case"open":return"warn";case"in_progress":return"accent";case"resolved":return"primary";default:return"primary"}}getPriorityColor(t){switch(t){case"high":return"warn";case"medium":return"accent";case"low":return"primary";default:return"primary"}}isFormValid(){return this.data.mode==="view"?!0:this.data.mode==="create"?this.ticketForm.valid:this.data.mode==="reply"?this.replyForm.valid:this.data.mode==="close"?this.closeForm.valid:!1}onCancel(){this.dialogRef.close()}onConfirm(){if(this.data.mode==="view")this.dialogRef.close();else if(this.data.mode==="create"){let t=this.ticketForm.value;this.dialogRef.close({action:"create",data:t})}else if(this.data.mode==="reply"){let t=this.replyForm.value;this.dialogRef.close({action:"reply",data:t})}else if(this.data.mode==="close"){let t=this.closeForm.value;this.dialogRef.close({action:"close",data:t})}}static \u0275fac=function(i){return new(i||o)(f(Ct),f(St),f(ct))};static \u0275cmp=w({type:o,selectors:[["app-support-dialog"]],decls:15,vars:8,consts:[[1,"support-dialog"],["mat-dialog-title",""],["class","ticket-details",4,"ngIf"],["class","ticket-form",4,"ngIf"],["class","reply-form",4,"ngIf"],["class","close-form",4,"ngIf"],["align","end"],["mat-button","",3,"click"],["mat-raised-button","","color","primary",3,"click","disabled"],[1,"ticket-details"],[1,"detail-row"],["selected","",3,"color"],[1,"ticket-form"],[3,"formGroup"],["appearance","outline",1,"full-width"],["matInput","","formControlName","subject","placeholder","Enter ticket subject"],["matInput","","formControlName","customerName","placeholder","Enter customer name"],["formControlName","priority"],["value","low"],["value","medium"],["value","high"],["matInput","","formControlName","description","placeholder","Describe the issue","rows","4"],[1,"reply-form"],[1,"ticket-info"],["matInput","","formControlName","message","placeholder","Type your reply here","rows","4"],["formControlName","status"],["value","open"],["value","in_progress"],["value","resolved"],[1,"close-form"],["matInput","","formControlName","resolution","placeholder","Describe how the issue was resolved","rows","3"]],template:function(i,a){i&1&&(r(0,"div",0)(1,"h2",1)(2,"mat-icon"),n(3),e(),n(4),e(),r(5,"mat-dialog-content"),s(6,oe,37,16,"div",2)(7,ne,24,1,"div",3)(8,re,24,3,"div",4)(9,ae,20,7,"div",5),e(),r(10,"mat-dialog-actions",6)(11,"button",7),_("click",function(){return a.onCancel()}),n(12,"Cancel"),e(),r(13,"button",8),_("click",function(){return a.onConfirm()}),n(14),e()()()),i&2&&(l(3),h(a.getDialogIcon()),l(),m(" ",a.getDialogTitle()," "),l(2),c("ngIf",a.data.mode==="view"&&a.data.ticket),l(),c("ngIf",a.data.mode==="create"),l(),c("ngIf",a.data.mode==="reply"&&a.data.ticket),l(),c("ngIf",a.data.mode==="close"&&a.data.ticket),l(4),c("disabled",!a.isFormValid()),l(),m(" ",a.getConfirmButtonText()," "))},dependencies:[N,Y,j,_t,kt,ht,R,O,B,Mt,vt,$,bt,q,$t,Bt,F,P,G,A,V,L,H,mt,rt,it,ot,nt,at,lt,D,I],styles:[".support-dialog[_ngcontent-%COMP%]{min-width:500px}.ticket-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]{margin-bottom:12px;display:flex;justify-content:space-between;align-items:center}.ticket-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]:last-child{flex-direction:column;align-items:flex-start}.ticket-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:8px 0 0;padding:8px;background-color:#f5f5f5;border-radius:4px}.full-width[_ngcontent-%COMP%]{width:100%;margin-bottom:16px}.reply-form[_ngcontent-%COMP%], .close-form[_ngcontent-%COMP%]{margin-top:16px}.ticket-info[_ngcontent-%COMP%]{margin-bottom:16px;padding:8px;background-color:#f5f5f5;border-radius:4px}mat-dialog-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}"]})};var le=()=>[];function ce(o,t){o&1&&(r(0,"th",18),n(1,"Ticket #"),e())}function me(o,t){if(o&1&&(r(0,"td",19),n(1),e()),o&2){let i=t.$implicit;l(),h(i.ticketNumber)}}function pe(o,t){o&1&&(r(0,"th",18),n(1,"Subject"),e())}function se(o,t){if(o&1&&(r(0,"td",19),n(1),e()),o&2){let i=t.$implicit;l(),h(i.subject)}}function de(o,t){o&1&&(r(0,"th",18),n(1,"Customer"),e())}function ue(o,t){if(o&1&&(r(0,"td",19),n(1),e()),o&2){let i=t.$implicit;l(),h(i.customerName)}}function fe(o,t){o&1&&(r(0,"th",18),n(1,"Priority"),e())}function ge(o,t){if(o&1&&(r(0,"td",19)(1,"mat-chip",20),n(2),C(3,"titlecase"),e()()),o&2){let i=t.$implicit,a=d();l(),c("color",a.getPriorityColor(i.priority)),l(),m(" ",k(3,2,i.priority)," ")}}function Ce(o,t){o&1&&(r(0,"th",18),n(1,"Status"),e())}function Se(o,t){if(o&1&&(r(0,"td",19)(1,"mat-chip",20),n(2),C(3,"titlecase"),e()()),o&2){let i=t.$implicit,a=d();l(),c("color",a.getStatusColor(i.status)),l(),m(" ",k(3,2,i.status)," ")}}function xe(o,t){o&1&&(r(0,"th",18),n(1,"Created"),e())}function _e(o,t){if(o&1&&(r(0,"td",19),n(1),C(2,"date"),e()),o&2){let i=t.$implicit;l(),h(E(2,1,i.createdAt,"MMM dd, yyyy"))}}function he(o,t){o&1&&(r(0,"th",18),n(1,"Actions"),e())}function ke(o,t){if(o&1){let i=Q();r(0,"td",19)(1,"button",21)(2,"mat-icon"),n(3,"more_vert"),e()(),r(4,"mat-menu",null,0)(6,"button",22),_("click",function(){let p=y(i).$implicit,u=d();return T(u.viewTicketDetails(p))}),r(7,"mat-icon"),n(8,"visibility"),e(),r(9,"span"),n(10,"View Details"),e()(),r(11,"button",22),_("click",function(){let p=y(i).$implicit,u=d();return T(u.replyToTicket(p))}),r(12,"mat-icon"),n(13,"reply"),e(),r(14,"span"),n(15,"Reply"),e()(),r(16,"button",22),_("click",function(){let p=y(i).$implicit,u=d();return T(u.closeTicket(p))}),r(17,"mat-icon"),n(18,"close"),e(),r(19,"span"),n(20,"Close Ticket"),e()()()()}if(o&2){let i=W(5);l(),c("matMenuTriggerFor",i)}}function ve(o,t){o&1&&g(0,"tr",23)}function Me(o,t){o&1&&g(0,"tr",24)}var Ut=class o{constructor(t,i,a,p,u){this.store=t;this.dialog=i;this.snackBar=a;this.dataService=p;this.persistence=u;this.tickets$=this.store.select(zt),this.loading$=this.store.select(Kt)}displayedColumns=["ticketNumber","subject","customerName","priority","status","createdAt","actions"];tickets$;loading$;ngOnInit(){this.persistence.loadList("support","/data/support.json").subscribe(t=>{this.store.dispatch(Ht({tickets:t}))})}getStatusColor(t){switch(t){case"open":return"warn";case"in_progress":return"accent";case"resolved":return"primary";default:return"primary"}}getPriorityColor(t){switch(t){case"high":return"warn";case"medium":return"accent";case"low":return"primary";default:return"primary"}}createNewTicket(){this.dialog.open(M,{width:"600px",data:{mode:"create"}}).afterClosed().subscribe(i=>{if(i&&i.action==="create"){let a=this.createTicketFromFormData(i.data);this.store.dispatch(Lt({ticket:a})),this.snackBar.open("Ticket created successfully!","Close",{duration:3e3}),console.log("Ticket created:",a),this.tickets$.subscribe(p=>{let u=[...p||[],a];this.persistence.saveList("support",u)}).unsubscribe()}})}viewTicketDetails(t){this.dialog.open(M,{width:"500px",data:{mode:"view",ticket:t}}).afterClosed().subscribe(a=>{console.log("Ticket details viewed for:",t.ticketNumber)})}replyToTicket(t){this.dialog.open(M,{width:"600px",data:{mode:"reply",ticket:t}}).afterClosed().subscribe(a=>{a&&a.action==="reply"&&(this.snackBar.open(`Reply sent for ${t.ticketNumber}`,"Close",{duration:3e3}),console.log("Reply sent:",a.data))})}closeTicket(t){t.status==="open"||t.status==="in_progress"?this.dialog.open(M,{width:"500px",data:{mode:"close",ticket:t}}).afterClosed().subscribe(a=>{if(a&&a.action==="close"){let p=J(U({},t),{status:"resolved"});this.store.dispatch(qt({ticket:p})),this.snackBar.open(`Ticket ${t.ticketNumber} closed successfully!`,"Close",{duration:3e3}),console.log("Ticket closed:",a.data),this.tickets$.subscribe(u=>{let Jt=(u||[]).map(K=>K.id===t.id?J(U({},K),{status:"resolved"}):K);this.persistence.saveList("support",Jt)}).unsubscribe()}}):this.snackBar.open("This ticket is already closed","Close",{duration:3e3})}createTicketFromFormData(t){let i=this.generateTicketId(),a=this.generateTicketNumber();return{id:i,ticketNumber:a,subject:t.subject,status:"open",priority:t.priority,customerName:t.customerName,createdAt:new Date().toISOString().split("T")[0],description:t.description}}generateTicketId(){let t=0;return this.tickets$.subscribe(i=>{t=i.length}).unsubscribe(),(t+1).toString()}generateTicketNumber(){let t=Date.now(),i=Math.floor(Math.random()*1e3);return`TICKET-${t}-${i}`}static \u0275fac=function(i){return new(i||o)(f(tt),f(xt),f(At),f(yt),f(Gt))};static \u0275cmp=w({type:o,selectors:[["app-support"]],decls:36,vars:6,consts:[["menu","matMenu"],[1,"support-container"],[1,"support-header"],["mat-raised-button","","color","primary",3,"click"],[1,"tickets-table-card"],[1,"table-container"],["mat-table","",1,"tickets-table",3,"dataSource"],["matColumnDef","ticketNumber"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","subject"],["matColumnDef","customerName"],["matColumnDef","priority"],["matColumnDef","status"],["matColumnDef","createdAt"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["selected","",3,"color"],["mat-icon-button","",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(i,a){i&1&&(r(0,"div",1)(1,"div",2)(2,"h1"),n(3,"Customer Support"),e(),r(4,"button",3),_("click",function(){return a.createNewTicket()}),r(5,"mat-icon"),n(6,"add"),e(),n(7," New Ticket "),e()(),r(8,"mat-card",4)(9,"mat-card-content")(10,"div",5)(11,"table",6),C(12,"async"),S(13,7),s(14,ce,2,0,"th",8)(15,me,2,1,"td",9),x(),S(16,10),s(17,pe,2,0,"th",8)(18,se,2,1,"td",9),x(),S(19,11),s(20,de,2,0,"th",8)(21,ue,2,1,"td",9),x(),S(22,12),s(23,fe,2,0,"th",8)(24,ge,4,4,"td",9),x(),S(25,13),s(26,Ce,2,0,"th",8)(27,Se,4,4,"td",9),x(),S(28,14),s(29,xe,2,0,"th",8)(30,_e,3,4,"td",9),x(),S(31,15),s(32,he,2,0,"th",8)(33,ke,21,1,"td",9),x(),s(34,ve,1,0,"tr",16)(35,Me,1,0,"tr",17),e()()()()()),i&2&&(l(11),c("dataSource",k(12,3,a.tickets$)||X(5,le)),l(23),c("matHeaderRowDef",a.displayedColumns),l(),c("matRowDefColumns",a.displayedColumns))},dependencies:[N,jt,Tt,Et,Pt,Dt,wt,Ft,It,Nt,Ot,Rt,G,A,V,R,O,pt,F,P,$,B,q,L,H,ft,dt,st,ut,j,Vt,gt,Z,D,I],styles:[".support-container[_ngcontent-%COMP%]{padding:24px;max-width:1200px;margin:0 auto}.support-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:24px}.support-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;font-size:32px;font-weight:300;color:#333}.tickets-table-card[_ngcontent-%COMP%]{border-radius:12px;box-shadow:0 2px 8px #0000001a}.table-container[_ngcontent-%COMP%]{overflow-x:auto}.tickets-table[_ngcontent-%COMP%]{width:100%}.tickets-table[_ngcontent-%COMP%]   mat-chip[_ngcontent-%COMP%]{font-size:12px;font-weight:500}@media (max-width: 768px){.support-container[_ngcontent-%COMP%]{padding:16px}.support-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:16px}.support-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:24px}}"]})};export{Ut as SupportComponent};
